<!-- HTML header for doxygen 1.8.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<title>Arm® CryptoCell™-713 Software Developers Manual: CryptoCell Diffie-Hellman Key Generation APIs</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="arm_sip_html.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="arm_logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Arm® CryptoCell™-713 Software Developers Manual
   &#160;<span id="projectnumber">r0p0</span>
   </div>
   <div id="projectbrief">Runtime API Layer</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group__cc__dh__kg.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">CryptoCell Diffie-Hellman Key Generation APIs<div class="ingroups"><a class="el" href="group__cc__dh.html">CryptoCell Diffie-Hellman APIs</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Contains the API that supports C domain.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_c_c_dh_kg_data__t.html">CCDhKgData_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_c_c_dh_kg_check_temp__t.html">CCDhKgCheckTemp_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga24fa568f1f8f47a1455c80038d492fb9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cc__dh__kg.html#ga24fa568f1f8f47a1455c80038d492fb9">CC_DH_SEED_MIN_SIZE_IN_BYTES</a>&#160;&#160;&#160;<a class="el" href="group__cc__hash__defs.html#ga886483e225b1bce569ba663813eba3ba">CC_HASH_SHA1_DIGEST_SIZE_IN_BYTES</a></td></tr>
<tr class="separator:ga24fa568f1f8f47a1455c80038d492fb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3f553403270cd3c2eca110d802a5bb38"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cc__dh__kg.html#ga3f553403270cd3c2eca110d802a5bb38">CC_DH_SEED_MIN_SIZE_IN_BITS</a>&#160;&#160;&#160;(<a class="el" href="group__cc__dh__kg.html#ga24fa568f1f8f47a1455c80038d492fb9">CC_DH_SEED_MIN_SIZE_IN_BYTES</a> * 8)</td></tr>
<tr class="separator:ga3f553403270cd3c2eca110d802a5bb38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9e813bb1575740ce5aa43b4ec300cbe3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cc__dh__kg.html#ga9e813bb1575740ce5aa43b4ec300cbe3">DH_X942_PRIME_MOD_MIN_VAL</a>&#160;&#160;&#160;1024</td></tr>
<tr class="separator:ga9e813bb1575740ce5aa43b4ec300cbe3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga740fb31e6b6ac9855b74f4dbb8d5bc93"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cc__dh__kg.html#ga740fb31e6b6ac9855b74f4dbb8d5bc93">DH_X942_PRIME_MOD_MAX_VAL</a>&#160;&#160;&#160;2048</td></tr>
<tr class="separator:ga740fb31e6b6ac9855b74f4dbb8d5bc93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga23cdccbfd422f882fac956d54e142e0b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cc__dh__kg.html#ga23cdccbfd422f882fac956d54e142e0b">DH_X942_PGEN_COUNTER_CONST</a>&#160;&#160;&#160;4096</td></tr>
<tr class="separator:ga23cdccbfd422f882fac956d54e142e0b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga88dd6487ddb85f8f79404a3c3fbd5d48"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cc__dh__kg.html#ga88dd6487ddb85f8f79404a3c3fbd5d48">DH_X942_HASH_SIZE_BITS</a>&#160;&#160;&#160;160</td></tr>
<tr class="separator:ga88dd6487ddb85f8f79404a3c3fbd5d48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad57101a2446d13012c5d7b8bbd490106"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cc__dh__kg.html#gad57101a2446d13012c5d7b8bbd490106">DH_SEED_MAX_ADDING_VAL</a>&#160;&#160;&#160;0xFFFFFFFF</td></tr>
<tr class="separator:gad57101a2446d13012c5d7b8bbd490106"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga75cf143f1659f162f059becf291cae4b"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct_c_c_dh_kg_data__t.html">CCDhKgData_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cc__dh__kg.html#ga75cf143f1659f162f059becf291cae4b">CCDhKgData_t</a></td></tr>
<tr class="separator:ga75cf143f1659f162f059becf291cae4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0c1495a2e56f716847d4b3e388cb2bf5"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct_c_c_dh_kg_check_temp__t.html">CCDhKgCheckTemp_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cc__dh__kg.html#ga0c1495a2e56f716847d4b3e388cb2bf5">CCDhKgCheckTemp_t</a></td></tr>
<tr class="separator:ga0c1495a2e56f716847d4b3e388cb2bf5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga7c4146267e7cb6b82fca208d5ef7f696"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cc__pal__types__plat_8h.html#ae6af89d003c202f74ab7bc4c8cd26b74">CIMPORT_C</a> <a class="el" href="cc__pal__types__plat_8h.html#a0524980129b7e5ec9d0998ddab83dd1a">CCError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cc__dh__kg.html#ga7c4146267e7cb6b82fca208d5ef7f696">CC_DhCreateDomainParams</a> (<a class="el" href="cc__pal__types__plat_8h.html#a0524980129b7e5ec9d0998ddab83dd1a">CCError_t</a>(*f_rng)(void *, unsigned char *, size_t), void *p_rng, uint32_t modPsizeBits, uint32_t orderQsizeBits, uint32_t seedSizeBits, uint8_t *modP_ptr, uint8_t *orderQ_ptr, uint8_t *generatorG_ptr, uint32_t *generGsizeBytes_ptr, uint8_t *factorJ_ptr, uint32_t *JsizeBytes_ptr, uint8_t *seedS_ptr, int8_t generateSeed, uint32_t *pgenCounter_ptr, <a class="el" href="struct_c_c_dh_kg_data__t.html">CCDhKgData_t</a> *DHKGbuff_ptr)</td></tr>
<tr class="memdesc:ga7c4146267e7cb6b82fca208d5ef7f696"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function generates DH domain parameters in Galois prime field according to the ANSI X9.42-2003: Public Key Cryptography for the Financial Services Industry: Agreement of Symmetric Keys Using Discrete Logarithm Cryptography standard. It receives the required sizes (in bits) of the modulus, the generator's order, and the seed, and then generates the prime modulus and the generator according to these parameters. If generateSeed argument is set to 1, the function generates and outputs the random seed. Otherwise (if set to 0), the seed has to be passed as an input argument. According to implementation value of the user passed seed should be not greater than (2^seedSizeBits - 2^32). The Seed and some additional parameters, generated by the function (factorJ, pgenCounter), are used for checking that all domain parameters are generated according to the standard and not forged.  <a href="#ga7c4146267e7cb6b82fca208d5ef7f696">More...</a><br /></td></tr>
<tr class="separator:ga7c4146267e7cb6b82fca208d5ef7f696"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga786ada4a4c20d1a59623098712d32b6f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cc__pal__types__plat_8h.html#ae6af89d003c202f74ab7bc4c8cd26b74">CIMPORT_C</a> <a class="el" href="cc__pal__types__plat_8h.html#a0524980129b7e5ec9d0998ddab83dd1a">CCError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cc__dh__kg.html#ga786ada4a4c20d1a59623098712d32b6f">CC_DhCheckDomainParams</a> (<a class="el" href="group__cc__rnd.html#gab41230bb62b4edb0a399e44b3c974f7f">CCRndGenerateVectWorkFunc_t</a> f_rng, void *p_rng, uint8_t *modP_ptr, uint32_t modPsizeBytes, uint8_t *orderQ_ptr, uint32_t orderQsizeBytes, uint8_t *generatorG_ptr, uint32_t generatorSizeBytes, uint8_t *seedS_ptr, uint32_t seedSizeBits, uint32_t pgenCounter, <a class="el" href="struct_c_c_dh_kg_check_temp__t.html">CCDhKgCheckTemp_t</a> *checkTempBuff_ptr)</td></tr>
<tr class="memdesc:ga786ada4a4c20d1a59623098712d32b6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function receives DH domain parameters, seed and prime generation counter and then verifies that the domain was created according to the ANSI X9.42-2003: Public Key Cryptography for the Financial Services Industry: Agreement of Symmetric Keys Using Discrete Logarithm Cryptography standard. The seed should be no greater than (2^seedSizeBits - 2^32), otherwise an error is returned.  <a href="#ga786ada4a4c20d1a59623098712d32b6f">More...</a><br /></td></tr>
<tr class="separator:ga786ada4a4c20d1a59623098712d32b6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Contains the API that supports C domain. </p>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ga3f553403270cd3c2eca110d802a5bb38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga3f553403270cd3c2eca110d802a5bb38">&#9670;&nbsp;</a></span>CC_DH_SEED_MIN_SIZE_IN_BITS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CC_DH_SEED_MIN_SIZE_IN_BITS&#160;&#160;&#160;(<a class="el" href="group__cc__dh__kg.html#ga24fa568f1f8f47a1455c80038d492fb9">CC_DH_SEED_MIN_SIZE_IN_BYTES</a> * 8)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Minimal size of DH seed in bits. </p>

</div>
</div>
<a id="ga24fa568f1f8f47a1455c80038d492fb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga24fa568f1f8f47a1455c80038d492fb9">&#9670;&nbsp;</a></span>CC_DH_SEED_MIN_SIZE_IN_BYTES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CC_DH_SEED_MIN_SIZE_IN_BYTES&#160;&#160;&#160;<a class="el" href="group__cc__hash__defs.html#ga886483e225b1bce569ba663813eba3ba">CC_HASH_SHA1_DIGEST_SIZE_IN_BYTES</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Minimal size of DH seed in bytes. </p>

</div>
</div>
<a id="gad57101a2446d13012c5d7b8bbd490106"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gad57101a2446d13012c5d7b8bbd490106">&#9670;&nbsp;</a></span>DH_SEED_MAX_ADDING_VAL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DH_SEED_MAX_ADDING_VAL&#160;&#160;&#160;0xFFFFFFFF</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Maximal seed additional data size. </p>

</div>
</div>
<a id="ga88dd6487ddb85f8f79404a3c3fbd5d48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga88dd6487ddb85f8f79404a3c3fbd5d48">&#9670;&nbsp;</a></span>DH_X942_HASH_SIZE_BITS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DH_X942_HASH_SIZE_BITS&#160;&#160;&#160;160</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>HASH size in bits for X942 - 160. </p>

</div>
</div>
<a id="ga23cdccbfd422f882fac956d54e142e0b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga23cdccbfd422f882fac956d54e142e0b">&#9670;&nbsp;</a></span>DH_X942_PGEN_COUNTER_CONST</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DH_X942_PGEN_COUNTER_CONST&#160;&#160;&#160;4096</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>PGeneration counter for X942 - 4096. </p>

</div>
</div>
<a id="ga740fb31e6b6ac9855b74f4dbb8d5bc93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga740fb31e6b6ac9855b74f4dbb8d5bc93">&#9670;&nbsp;</a></span>DH_X942_PRIME_MOD_MAX_VAL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DH_X942_PRIME_MOD_MAX_VAL&#160;&#160;&#160;2048</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Maximal modulus size for X942 - 2048. </p>

</div>
</div>
<a id="ga9e813bb1575740ce5aa43b4ec300cbe3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga9e813bb1575740ce5aa43b4ec300cbe3">&#9670;&nbsp;</a></span>DH_X942_PRIME_MOD_MIN_VAL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DH_X942_PRIME_MOD_MIN_VAL&#160;&#160;&#160;1024</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Minimal modulus size for X942 - 1024. </p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="ga0c1495a2e56f716847d4b3e388cb2bf5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0c1495a2e56f716847d4b3e388cb2bf5">&#9670;&nbsp;</a></span>CCDhKgCheckTemp_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct_c_c_dh_kg_check_temp__t.html">CCDhKgCheckTemp_t</a> <a class="el" href="struct_c_c_dh_kg_check_temp__t.html">CCDhKgCheckTemp_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Temporary buffer structure. </p>

</div>
</div>
<a id="ga75cf143f1659f162f059becf291cae4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga75cf143f1659f162f059becf291cae4b">&#9670;&nbsp;</a></span>CCDhKgData_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct_c_c_dh_kg_data__t.html">CCDhKgData_t</a> <a class="el" href="struct_c_c_dh_kg_data__t.html">CCDhKgData_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Temporary data buffer structure for domain parameters generation in DH. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga786ada4a4c20d1a59623098712d32b6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga786ada4a4c20d1a59623098712d32b6f">&#9670;&nbsp;</a></span>CC_DhCheckDomainParams()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cc__pal__types__plat_8h.html#ae6af89d003c202f74ab7bc4c8cd26b74">CIMPORT_C</a> <a class="el" href="cc__pal__types__plat_8h.html#a0524980129b7e5ec9d0998ddab83dd1a">CCError_t</a> CC_DhCheckDomainParams </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__cc__rnd.html#gab41230bb62b4edb0a399e44b3c974f7f">CCRndGenerateVectWorkFunc_t</a>&#160;</td>
          <td class="paramname"><em>f_rng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p_rng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>modP_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>modPsizeBytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>orderQ_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>orderQsizeBytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>generatorG_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>generatorSizeBytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>seedS_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>seedSizeBits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>pgenCounter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_c_c_dh_kg_check_temp__t.html">CCDhKgCheckTemp_t</a> *&#160;</td>
          <td class="paramname"><em>checkTempBuff_ptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function receives DH domain parameters, seed and prime generation counter and then verifies that the domain was created according to the ANSI X9.42-2003: Public Key Cryptography for the Financial Services Industry: Agreement of Symmetric Keys Using Discrete Logarithm Cryptography standard. The seed should be no greater than (2^seedSizeBits - 2^32), otherwise an error is returned. </p>
<dl class="section note"><dt>Note</dt><dd>All buffer parameters should be in big-endian form. For a description of the parameters see <a class="el" href="group__cc__ecpki.html#ga6f88125a59128d89779e2fd571bc66e0" title="Builds a user public key structure from an imported public key, so it can be used by other EC primiti...">CC_EcpkiPublKeyBuildAndCheck</a>.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd><code>CC_OK</code> on success. </dd>
<dd>
A non-zero value on failure as defined <a class="el" href="cc__dh__error_8h.html" title="This file contains error codes definitions for CryptoCell Diffie-Hellman module.">cc_dh_error.h</a>, <a class="el" href="cc__rnd__error_8h.html" title="This file contains the definitions of the CryptoCell RND errors.">cc_rnd_error.h</a> or <a class="el" href="cc__hash__error_8h.html" title="This file contains the definitions of the CryptoCell hash errors.">cc_hash_error.h</a>. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">f_rng</td><td>Pointer to DRBG function </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">p_rng</td><td>Pointer to the random context - the input to f_rng. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">modP_ptr</td><td>Pointer to the modulus (Prime). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">modPsizeBytes</td><td>Size of the modulus (Prime) in bytes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">orderQ_ptr</td><td>Pointer to the order Q of generator. The size of the buffer for output generated value must be no less than the order size. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">orderQsizeBytes</td><td>Size of the Generator's order in bytes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">generatorG_ptr</td><td>Pointer to the generator of the multiplicative subgroup in GF(P). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">generatorSizeBytes</td><td>Size of the generator in bytes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">seedS_ptr</td><td>Random seed used for prime generation. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">seedSizeBits</td><td>Seed size in bits. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pgenCounter</td><td>Counter of prime generation attempts. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">checkTempBuff_ptr</td><td>Temporary buffer for internal calculations. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga7c4146267e7cb6b82fca208d5ef7f696"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7c4146267e7cb6b82fca208d5ef7f696">&#9670;&nbsp;</a></span>CC_DhCreateDomainParams()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cc__pal__types__plat_8h.html#ae6af89d003c202f74ab7bc4c8cd26b74">CIMPORT_C</a> <a class="el" href="cc__pal__types__plat_8h.html#a0524980129b7e5ec9d0998ddab83dd1a">CCError_t</a> CC_DhCreateDomainParams </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="cc__pal__types__plat_8h.html#a0524980129b7e5ec9d0998ddab83dd1a">CCError_t</a>(*)(void *, unsigned char *, size_t)&#160;</td>
          <td class="paramname"><em>f_rng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p_rng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>modPsizeBits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>orderQsizeBits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>seedSizeBits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>modP_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>orderQ_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>generatorG_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>generGsizeBytes_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>factorJ_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>JsizeBytes_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>seedS_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int8_t&#160;</td>
          <td class="paramname"><em>generateSeed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t *&#160;</td>
          <td class="paramname"><em>pgenCounter_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_c_c_dh_kg_data__t.html">CCDhKgData_t</a> *&#160;</td>
          <td class="paramname"><em>DHKGbuff_ptr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function generates DH domain parameters in Galois prime field according to the ANSI X9.42-2003: Public Key Cryptography for the Financial Services Industry: Agreement of Symmetric Keys Using Discrete Logarithm Cryptography standard. It receives the required sizes (in bits) of the modulus, the generator's order, and the seed, and then generates the prime modulus and the generator according to these parameters. If generateSeed argument is set to 1, the function generates and outputs the random seed. Otherwise (if set to 0), the seed has to be passed as an input argument. According to implementation value of the user passed seed should be not greater than (2^seedSizeBits - 2^32). The Seed and some additional parameters, generated by the function (factorJ, pgenCounter), are used for checking that all domain parameters are generated according to the standard and not forged. </p>
<dl class="section note"><dt>Note</dt><dd>All buffer parameters should be in big-endian form.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd><code>CC_OK</code> on success. </dd>
<dd>
A non-zero value on failure as defined <a class="el" href="cc__dh__error_8h.html" title="This file contains error codes definitions for CryptoCell Diffie-Hellman module.">cc_dh_error.h</a>, <a class="el" href="cc__rnd__error_8h.html" title="This file contains the definitions of the CryptoCell RND errors.">cc_rnd_error.h</a> or <a class="el" href="cc__hash__error_8h.html" title="This file contains the definitions of the CryptoCell hash errors.">cc_hash_error.h</a>. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">f_rng</td><td>in - Pointer to DRBG function </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">p_rng</td><td>in/out - Pointer to the random context - the input to f_rng. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">modPsizeBits</td><td>Size of the modulus (Prime) in bits equal 256*n, where n &gt;= 4. FIPS Publication 186-4: Digital Signature Standard (DSS) defines sizes 1024 and 2048 bit. Maximal size is 4096 bits. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">orderQsizeBits</td><td>Size of the Generator's order in bits. FIPS Publication 186-4: Digital Signature Standard (DSS) defines orderQSizeBits = 160 for modulus 1024 bit and 224 or 256 bit for modPSizeBits = 2048. It is not recommended to use sizes &gt; 256. The API returns an error if orderQSizeBits &gt; modPSizeBits/4. The allowed sizes are multiples of 32 bits. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">seedSizeBits</td><td>Seed size in bits. Requirements: modPSizeBits &gt;= seedSizeBits &gt;= orderQSizeBits (the first is required by our implementation). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">modP_ptr</td><td>Pointer to the modulus (Prime) buffer of defined structure. The size of the buffer for output generated value must be no less than modulus size. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">orderQ_ptr</td><td>Pointer to the order Q of generator. The size of the buffer for output generated value must be no less than the order size. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">generatorG_ptr</td><td>Pointer to the generator of multiplicative subgroup in GF(P). If the user does not need this output, then both the pointer and the buffer size must be set to 0. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">generGsizeBytes_ptr</td><td>Pointer to the one word buffer for outputting the generator's size. The passed size (if needed) must be no less than modulus size. The function returns the actual size of the generator. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">factorJ_ptr</td><td>Pointer to the buffer for integer factor J. If NULL, the function does not output this parameter. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">JsizeBytes_ptr</td><td>Pointer to the size of integer factor J. If NULL, the function does not output this parameter. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">seedS_ptr</td><td>Random seed used for prime generation. The size of the buffer for output generated value must be at least the seed size. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">generateSeed</td><td>Flag defining whether the seed should be generated randomly by the function (1) or passed by the user (0). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pgenCounter_ptr</td><td>Pointer to counter of tries to generate the primes. If NULL, the function does not output this parameter. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">DHKGbuff_ptr</td><td>The temp buffer of defined structure for internal calculations. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Copyright © 2001-2020 Arm Limited. All rights reserved. Non-Confidential.</li>
  </ul>
</div>
</body>
</html>
