<!-- HTML header for doxygen 1.8.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<title>Arm® CryptoCell™-713 Software Developers Manual: SM4 APIs</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="arm_sip_html.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="arm_logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Arm® CryptoCell™-713 Software Developers Manual
   &#160;<span id="projectnumber">r0p0</span>
   </div>
   <div id="projectbrief">Runtime API Layer</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group__cc__sm4.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#groups">Modules</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">SM4 APIs<div class="ingroups"><a class="el" href="group__ch__crypto.html">Chinese certification cryptographic APIs</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Contains SM4 APIs and definitions.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="groups"></a>
Modules</h2></td></tr>
<tr class="memitem:group__cc__sm4__defs"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cc__sm4__defs.html">CryptoCell SM4 type definitions</a></td></tr>
<tr class="memdesc:group__cc__sm4__defs"><td class="mdescLeft">&#160;</td><td class="mdescRight">Contains CryptoCell SM4 type definitions. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:group__cc__sm4__error"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cc__sm4__error.html">CryptoCell SM4-specific errors</a></td></tr>
<tr class="memdesc:group__cc__sm4__error"><td class="mdescLeft">&#160;</td><td class="mdescRight">Contains the definitions of the CryptoCell SM4 errors. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga1164ff1f48b44cc8ce64b83d6d3234a9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cc__pal__types__plat_8h.html#ae6af89d003c202f74ab7bc4c8cd26b74">CIMPORT_C</a> <a class="el" href="cc__pal__types__plat_8h.html#a0524980129b7e5ec9d0998ddab83dd1a">CCError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cc__sm4.html#ga1164ff1f48b44cc8ce64b83d6d3234a9">CC_Sm4Init</a> (<a class="el" href="struct_c_c_sm4_user_context__t.html">CCSm4UserContext_t</a> *pContext, <a class="el" href="group__cc__sm4__defs.html#gad024253f6b97ce3d705d8c7bda7482cc">CCSm4EncryptMode_t</a> encryptDecryptFlag, <a class="el" href="group__cc__sm4__defs.html#ga39a11c39a0fa6ed4547588fd7b0d0967">CCSm4OperationMode_t</a> operationMode)</td></tr>
<tr class="memdesc:ga1164ff1f48b44cc8ce64b83d6d3234a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is used to initialize a SM4 operation context. This must be the first API called to operate the SM4 cryptographic machine.  <a href="#ga1164ff1f48b44cc8ce64b83d6d3234a9">More...</a><br /></td></tr>
<tr class="separator:ga1164ff1f48b44cc8ce64b83d6d3234a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0579ddef3831439a97d87e12b442e015"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cc__pal__types__plat_8h.html#ae6af89d003c202f74ab7bc4c8cd26b74">CIMPORT_C</a> <a class="el" href="cc__pal__types__plat_8h.html#a0524980129b7e5ec9d0998ddab83dd1a">CCError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cc__sm4.html#ga0579ddef3831439a97d87e12b442e015">CC_Sm4SetKey</a> (<a class="el" href="struct_c_c_sm4_user_context__t.html">CCSm4UserContext_t</a> *pContext, <a class="el" href="group__cc__sm4__defs.html#gafe4fc212425e9b0e7829eb10810285f2">CCSm4Key_t</a> pKey)</td></tr>
<tr class="memdesc:ga0579ddef3831439a97d87e12b442e015"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function sets the key information for the SM4 operation, in the context that was initialized by <a class="el" href="group__cc__sm4.html#ga1164ff1f48b44cc8ce64b83d6d3234a9" title="This function is used to initialize a SM4 operation context. This must be the first API called to ope...">CC_Sm4Init()</a>.  <a href="#ga0579ddef3831439a97d87e12b442e015">More...</a><br /></td></tr>
<tr class="separator:ga0579ddef3831439a97d87e12b442e015"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2be1133d50851c50ccd22e43b7cca6d7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cc__pal__types__plat_8h.html#ae6af89d003c202f74ab7bc4c8cd26b74">CIMPORT_C</a> <a class="el" href="cc__pal__types__plat_8h.html#a0524980129b7e5ec9d0998ddab83dd1a">CCError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cc__sm4.html#ga2be1133d50851c50ccd22e43b7cca6d7">CC_Sm4SetIv</a> (<a class="el" href="struct_c_c_sm4_user_context__t.html">CCSm4UserContext_t</a> *pContext, <a class="el" href="group__cc__sm4__defs.html#gae2c7dbcad0b3febfede78badb2efe66a">CCSm4Iv_t</a> pIV)</td></tr>
<tr class="memdesc:ga2be1133d50851c50ccd22e43b7cca6d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function sets the IV or counter data for the following SM4 operations on the same context. The context must be first initialized by <a class="el" href="group__cc__sm4.html#ga1164ff1f48b44cc8ce64b83d6d3234a9" title="This function is used to initialize a SM4 operation context. This must be the first API called to ope...">CC_Sm4Init()</a>. It must be called at least once prior to the first <a class="el" href="group__cc__sm4.html#gab446dc6a54a6df7ddd45165e867c5df9" title="This function performs a SM4 operation on an input data buffer, according to the configuration define...">CC_Sm4Block()</a> operation on the same context - for those ciphers that require it. If needed, it can also be called to override the IV in the middle of a sequence of <a class="el" href="group__cc__sm4.html#gab446dc6a54a6df7ddd45165e867c5df9" title="This function performs a SM4 operation on an input data buffer, according to the configuration define...">CC_Sm4Block()</a> operations.  <a href="#ga2be1133d50851c50ccd22e43b7cca6d7">More...</a><br /></td></tr>
<tr class="separator:ga2be1133d50851c50ccd22e43b7cca6d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga912ccb9aa520a859d6a5246a7ce276f5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cc__pal__types__plat_8h.html#ae6af89d003c202f74ab7bc4c8cd26b74">CIMPORT_C</a> <a class="el" href="cc__pal__types__plat_8h.html#a0524980129b7e5ec9d0998ddab83dd1a">CCError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cc__sm4.html#ga912ccb9aa520a859d6a5246a7ce276f5">CC_Sm4GetIv</a> (<a class="el" href="struct_c_c_sm4_user_context__t.html">CCSm4UserContext_t</a> *pContext, <a class="el" href="group__cc__sm4__defs.html#gae2c7dbcad0b3febfede78badb2efe66a">CCSm4Iv_t</a> pIV)</td></tr>
<tr class="memdesc:ga912ccb9aa520a859d6a5246a7ce276f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function retrieves the current IV or counter data from the SM4 context.  <a href="#ga912ccb9aa520a859d6a5246a7ce276f5">More...</a><br /></td></tr>
<tr class="separator:ga912ccb9aa520a859d6a5246a7ce276f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gab446dc6a54a6df7ddd45165e867c5df9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cc__pal__types__plat_8h.html#ae6af89d003c202f74ab7bc4c8cd26b74">CIMPORT_C</a> <a class="el" href="cc__pal__types__plat_8h.html#a0524980129b7e5ec9d0998ddab83dd1a">CCError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cc__sm4.html#gab446dc6a54a6df7ddd45165e867c5df9">CC_Sm4Block</a> (<a class="el" href="struct_c_c_sm4_user_context__t.html">CCSm4UserContext_t</a> *pContext, uint8_t *pDataIn, size_t dataSize, uint8_t *pDataOut)</td></tr>
<tr class="memdesc:gab446dc6a54a6df7ddd45165e867c5df9"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function performs a SM4 operation on an input data buffer, according to the configuration defined in the context parameter. It can be called as many times as needed, until all the input data is processed. The functions <a class="el" href="group__cc__sm4.html#ga1164ff1f48b44cc8ce64b83d6d3234a9" title="This function is used to initialize a SM4 operation context. This must be the first API called to ope...">CC_Sm4Init()</a>, <a class="el" href="group__cc__sm4.html#ga0579ddef3831439a97d87e12b442e015" title="This function sets the key information for the SM4 operation, in the context that was initialized by ...">CC_Sm4SetKey()</a>, and for some ciphers <a class="el" href="group__cc__sm4.html#ga2be1133d50851c50ccd22e43b7cca6d7" title="This function sets the IV or counter data for the following SM4 operations on the same context....">CC_Sm4SetIv()</a>, must be called before the first call to this API with the same context.  <a href="#gab446dc6a54a6df7ddd45165e867c5df9">More...</a><br /></td></tr>
<tr class="separator:gab446dc6a54a6df7ddd45165e867c5df9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga91c1f86cfe370cc3798d13b444a916da"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cc__pal__types__plat_8h.html#ae6af89d003c202f74ab7bc4c8cd26b74">CIMPORT_C</a> <a class="el" href="cc__pal__types__plat_8h.html#a0524980129b7e5ec9d0998ddab83dd1a">CCError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cc__sm4.html#ga91c1f86cfe370cc3798d13b444a916da">CC_Sm4Finish</a> (<a class="el" href="struct_c_c_sm4_user_context__t.html">CCSm4UserContext_t</a> *pContext, uint8_t *pDataIn, size_t dataSize, uint8_t *pDataOut)</td></tr>
<tr class="memdesc:ga91c1f86cfe370cc3798d13b444a916da"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is used to finish SM4 operation. It processes the last data block if needed, and finalizes the SM4 operation (cipher-specific).  <a href="#ga91c1f86cfe370cc3798d13b444a916da">More...</a><br /></td></tr>
<tr class="separator:ga91c1f86cfe370cc3798d13b444a916da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga49abe57e4e6e4557e70d8600cfcf1355"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cc__pal__types__plat_8h.html#ae6af89d003c202f74ab7bc4c8cd26b74">CIMPORT_C</a> <a class="el" href="cc__pal__types__plat_8h.html#a0524980129b7e5ec9d0998ddab83dd1a">CCError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cc__sm4.html#ga49abe57e4e6e4557e70d8600cfcf1355">CC_Sm4Free</a> (<a class="el" href="struct_c_c_sm4_user_context__t.html">CCSm4UserContext_t</a> *pContext)</td></tr>
<tr class="memdesc:ga49abe57e4e6e4557e70d8600cfcf1355"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function releases and clears resources after SM4 operations.  <a href="#ga49abe57e4e6e4557e70d8600cfcf1355">More...</a><br /></td></tr>
<tr class="separator:ga49abe57e4e6e4557e70d8600cfcf1355"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4fb8dc4dde09d09171f4eb3519db04bc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cc__pal__types__plat_8h.html#ae6af89d003c202f74ab7bc4c8cd26b74">CIMPORT_C</a> <a class="el" href="cc__pal__types__plat_8h.html#a0524980129b7e5ec9d0998ddab83dd1a">CCError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cc__sm4.html#ga4fb8dc4dde09d09171f4eb3519db04bc">CC_Sm4</a> (<a class="el" href="group__cc__sm4__defs.html#gae2c7dbcad0b3febfede78badb2efe66a">CCSm4Iv_t</a> pIV, <a class="el" href="group__cc__sm4__defs.html#gafe4fc212425e9b0e7829eb10810285f2">CCSm4Key_t</a> pKey, <a class="el" href="group__cc__sm4__defs.html#gad024253f6b97ce3d705d8c7bda7482cc">CCSm4EncryptMode_t</a> encryptDecryptFlag, <a class="el" href="group__cc__sm4__defs.html#ga39a11c39a0fa6ed4547588fd7b0d0967">CCSm4OperationMode_t</a> operationMode, uint8_t *pDataIn, size_t dataSize, uint8_t *pDataOut)</td></tr>
<tr class="memdesc:ga4fb8dc4dde09d09171f4eb3519db04bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function performs a SM4 operation with a given key in a single call for all SM4 supported modes, and can be used when all data is available at the beginning of the operation.  <a href="#ga4fb8dc4dde09d09171f4eb3519db04bc">More...</a><br /></td></tr>
<tr class="separator:ga4fb8dc4dde09d09171f4eb3519db04bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Contains SM4 APIs and definitions. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga4fb8dc4dde09d09171f4eb3519db04bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4fb8dc4dde09d09171f4eb3519db04bc">&#9670;&nbsp;</a></span>CC_Sm4()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cc__pal__types__plat_8h.html#ae6af89d003c202f74ab7bc4c8cd26b74">CIMPORT_C</a> <a class="el" href="cc__pal__types__plat_8h.html#a0524980129b7e5ec9d0998ddab83dd1a">CCError_t</a> CC_Sm4 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__cc__sm4__defs.html#gae2c7dbcad0b3febfede78badb2efe66a">CCSm4Iv_t</a>&#160;</td>
          <td class="paramname"><em>pIV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__cc__sm4__defs.html#gafe4fc212425e9b0e7829eb10810285f2">CCSm4Key_t</a>&#160;</td>
          <td class="paramname"><em>pKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__cc__sm4__defs.html#gad024253f6b97ce3d705d8c7bda7482cc">CCSm4EncryptMode_t</a>&#160;</td>
          <td class="paramname"><em>encryptDecryptFlag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__cc__sm4__defs.html#ga39a11c39a0fa6ed4547588fd7b0d0967">CCSm4OperationMode_t</a>&#160;</td>
          <td class="paramname"><em>operationMode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pDataIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>dataSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pDataOut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function performs a SM4 operation with a given key in a single call for all SM4 supported modes, and can be used when all data is available at the beginning of the operation. </p>
<dl class="section note"><dt>Note</dt><dd>For OFB this function does not support buffer in-place operation (pDataIn != pDataOut).</dd></dl>
<dl class="section return"><dt>Returns</dt><dd><code>CC_OK</code> on success, </dd>
<dd>
A non-zero value from <a class="el" href="cc__sm4__error_8h.html" title="This file contains the definitions of the CryptoCell SM4 errors.">cc_sm4_error.h</a> on failure. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pIV</td><td>Pointer to the buffer of the IV or counter. <ul>
<li>
ForCBC mode - the IV value. </li>
<li>
For CTR mode - the counter.</li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pKey</td><td>Pointer to the key data struct to be used for the SM4 operation. Must be 128 bits. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">encryptDecryptFlag</td><td>A flag specifying whether an SM4 Encrypt (CC_SM4_ENCRYPT) or Decrypt (CC_SM4_DECRYPT) operation should be performed. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">operationMode</td><td>The operation cipher/mode: ECB / CBC / CTR. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pDataIn</td><td>Pointer to the buffer of the input data to the SM4. The pointer does not need to be aligned. For TrustZone, the size of the scatter/gather list representing the data buffer is limited to 128 entries, and the size of each entry is limited to 64KB (fragments larger than 64KB are broken into fragments &lt;= 64KB). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dataSize</td><td>Size of the input data in bytes. For all modes it must be &gt;0, and a multiple of 16 bytes. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pDataOut</td><td>Pointer to the output buffer. The pointer does not need to be aligned. For TrustZone, the size of the scatter/gather list that represents the data buffer is limited to 128 entries, and the size of each entry is limited to 64KB (entries larger than 64KB are broken into fragments &lt;= 64KB). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gab446dc6a54a6df7ddd45165e867c5df9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gab446dc6a54a6df7ddd45165e867c5df9">&#9670;&nbsp;</a></span>CC_Sm4Block()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cc__pal__types__plat_8h.html#ae6af89d003c202f74ab7bc4c8cd26b74">CIMPORT_C</a> <a class="el" href="cc__pal__types__plat_8h.html#a0524980129b7e5ec9d0998ddab83dd1a">CCError_t</a> CC_Sm4Block </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_c_c_sm4_user_context__t.html">CCSm4UserContext_t</a> *&#160;</td>
          <td class="paramname"><em>pContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pDataIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>dataSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pDataOut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function performs a SM4 operation on an input data buffer, according to the configuration defined in the context parameter. It can be called as many times as needed, until all the input data is processed. The functions <a class="el" href="group__cc__sm4.html#ga1164ff1f48b44cc8ce64b83d6d3234a9" title="This function is used to initialize a SM4 operation context. This must be the first API called to ope...">CC_Sm4Init()</a>, <a class="el" href="group__cc__sm4.html#ga0579ddef3831439a97d87e12b442e015" title="This function sets the key information for the SM4 operation, in the context that was initialized by ...">CC_Sm4SetKey()</a>, and for some ciphers <a class="el" href="group__cc__sm4.html#ga2be1133d50851c50ccd22e43b7cca6d7" title="This function sets the IV or counter data for the following SM4 operations on the same context....">CC_Sm4SetIv()</a>, must be called before the first call to this API with the same context. </p>
<dl class="section note"><dt>Note</dt><dd>For OFB this function does not support buffer in-place operation (pDataIn != pDataOut).</dd></dl>
<dl class="section return"><dt>Returns</dt><dd><code>CC_OK</code> on success, </dd>
<dd>
A non-zero value from <a class="el" href="cc__sm4__error_8h.html" title="This file contains the definitions of the CryptoCell SM4 errors.">cc_sm4_error.h</a> on failure. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pContext</td><td>Pointer to the SM4 context. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pDataIn</td><td>Pointer to the buffer of the input data to the SM4. The pointer does not need to be aligned. For TrustZone, the size of the scatter/gather list that represents the data buffer is limited to 128 entries, and the size of each entry is limited to 64KB (entries larger than 64KB are broken into fragments &lt;= 64KB). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dataSize</td><td>Size of the input data in bytes. For all modes it must be &gt;0 and a multiple of 16 bytes. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pDataOut</td><td>Pointer to the output buffer. The pointer does not need to be aligned. For TrustZone, the size of the scatter/gather list that represents the data buffer is limited to 128 entries, and the size of each entry is limited to 64KB (entries larger than 64KB are broken into fragments &lt;= 64KB). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga91c1f86cfe370cc3798d13b444a916da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga91c1f86cfe370cc3798d13b444a916da">&#9670;&nbsp;</a></span>CC_Sm4Finish()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cc__pal__types__plat_8h.html#ae6af89d003c202f74ab7bc4c8cd26b74">CIMPORT_C</a> <a class="el" href="cc__pal__types__plat_8h.html#a0524980129b7e5ec9d0998ddab83dd1a">CCError_t</a> CC_Sm4Finish </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_c_c_sm4_user_context__t.html">CCSm4UserContext_t</a> *&#160;</td>
          <td class="paramname"><em>pContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pDataIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>dataSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pDataOut</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is used to finish SM4 operation. It processes the last data block if needed, and finalizes the SM4 operation (cipher-specific). </p>
<dl class="section note"><dt>Note</dt><dd>For OFB this function does not support buffer in-place operation (pDataIn != pDataOut).</dd></dl>
<dl class="section return"><dt>Returns</dt><dd><code>CC_OK</code> on success, </dd>
<dd>
A non-zero value from <a class="el" href="cc__sm4__error_8h.html" title="This file contains the definitions of the CryptoCell SM4 errors.">cc_sm4_error.h</a> on failure. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pContext</td><td>Pointer to the SM4 context. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pDataIn</td><td>Pointer to the buffer of the input data to the SM4. The pointer does not need to be aligned. For TrustZone, the size of the scatter/gather list that represents the data buffer is limited to 128 entries, and the size of each entry is limited to 64KB (entries larger than 64KB are broken into fragments &lt;= 64KB). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dataSize</td><td>The size of the input data in bytes. Can be 0. For ECB and CBC modes it must be a multiple of 16 bytes. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pDataOut</td><td>Pointer to the output buffer. The pointer does not need to be aligned. For TrustZone, the size of the scatter/gather list that represents the data buffer is limited to 128 entries, and the size of each entry is limited to 64KB (entries larger than 64KB are broken into fragments &lt;= 64KB). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga49abe57e4e6e4557e70d8600cfcf1355"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga49abe57e4e6e4557e70d8600cfcf1355">&#9670;&nbsp;</a></span>CC_Sm4Free()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cc__pal__types__plat_8h.html#ae6af89d003c202f74ab7bc4c8cd26b74">CIMPORT_C</a> <a class="el" href="cc__pal__types__plat_8h.html#a0524980129b7e5ec9d0998ddab83dd1a">CCError_t</a> CC_Sm4Free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_c_c_sm4_user_context__t.html">CCSm4UserContext_t</a> *&#160;</td>
          <td class="paramname"><em>pContext</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function releases and clears resources after SM4 operations. </p>
<dl class="section return"><dt>Returns</dt><dd><code>CC_OK</code> on success, </dd>
<dd>
A non-zero value from <a class="el" href="cc__sm4__error_8h.html" title="This file contains the definitions of the CryptoCell SM4 errors.">cc_sm4_error.h</a> on failure. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pContext</td><td>Pointer to the SM4 context. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga912ccb9aa520a859d6a5246a7ce276f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga912ccb9aa520a859d6a5246a7ce276f5">&#9670;&nbsp;</a></span>CC_Sm4GetIv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cc__pal__types__plat_8h.html#ae6af89d003c202f74ab7bc4c8cd26b74">CIMPORT_C</a> <a class="el" href="cc__pal__types__plat_8h.html#a0524980129b7e5ec9d0998ddab83dd1a">CCError_t</a> CC_Sm4GetIv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_c_c_sm4_user_context__t.html">CCSm4UserContext_t</a> *&#160;</td>
          <td class="paramname"><em>pContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__cc__sm4__defs.html#gae2c7dbcad0b3febfede78badb2efe66a">CCSm4Iv_t</a>&#160;</td>
          <td class="paramname"><em>pIV</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function retrieves the current IV or counter data from the SM4 context. </p>
<dl class="section return"><dt>Returns</dt><dd><code>CC_OK</code> on success, </dd>
<dd>
A non-zero value from <a class="el" href="cc__sm4__error_8h.html" title="This file contains the definitions of the CryptoCell SM4 errors.">cc_sm4_error.h</a> on failure. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pContext</td><td>Pointer to the SM4 context. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pIV</td><td>Pointer to the buffer of the IV or counter. <ul>
<li>
For CBC mode - the IV value. </li>
<li>
For CTR mode - the counter. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga1164ff1f48b44cc8ce64b83d6d3234a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1164ff1f48b44cc8ce64b83d6d3234a9">&#9670;&nbsp;</a></span>CC_Sm4Init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cc__pal__types__plat_8h.html#ae6af89d003c202f74ab7bc4c8cd26b74">CIMPORT_C</a> <a class="el" href="cc__pal__types__plat_8h.html#a0524980129b7e5ec9d0998ddab83dd1a">CCError_t</a> CC_Sm4Init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_c_c_sm4_user_context__t.html">CCSm4UserContext_t</a> *&#160;</td>
          <td class="paramname"><em>pContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__cc__sm4__defs.html#gad024253f6b97ce3d705d8c7bda7482cc">CCSm4EncryptMode_t</a>&#160;</td>
          <td class="paramname"><em>encryptDecryptFlag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__cc__sm4__defs.html#ga39a11c39a0fa6ed4547588fd7b0d0967">CCSm4OperationMode_t</a>&#160;</td>
          <td class="paramname"><em>operationMode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is used to initialize a SM4 operation context. This must be the first API called to operate the SM4 cryptographic machine. </p>
<dl class="section return"><dt>Returns</dt><dd><code>CC_OK</code> on success, </dd>
<dd>
A non-zero value from <a class="el" href="cc__sm4__error_8h.html" title="This file contains the definitions of the CryptoCell SM4 errors.">cc_sm4_error.h</a> on failure. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pContext</td><td>Pointer to the SM4 context buffer that is allocated by the caller and initialized by this API. Must be used in all subsequent calls that are part of the same operation. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">encryptDecryptFlag</td><td>A flag specifying whether an SM4 Encrypt (CC_SM4_ENCRYPT) or Decrypt (CC_SM4_DECRYPT) operation should be performed. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">operationMode</td><td>The operation cipher/mode: ECB / CBC / CTR / OFB. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga2be1133d50851c50ccd22e43b7cca6d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga2be1133d50851c50ccd22e43b7cca6d7">&#9670;&nbsp;</a></span>CC_Sm4SetIv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cc__pal__types__plat_8h.html#ae6af89d003c202f74ab7bc4c8cd26b74">CIMPORT_C</a> <a class="el" href="cc__pal__types__plat_8h.html#a0524980129b7e5ec9d0998ddab83dd1a">CCError_t</a> CC_Sm4SetIv </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_c_c_sm4_user_context__t.html">CCSm4UserContext_t</a> *&#160;</td>
          <td class="paramname"><em>pContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__cc__sm4__defs.html#gae2c7dbcad0b3febfede78badb2efe66a">CCSm4Iv_t</a>&#160;</td>
          <td class="paramname"><em>pIV</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function sets the IV or counter data for the following SM4 operations on the same context. The context must be first initialized by <a class="el" href="group__cc__sm4.html#ga1164ff1f48b44cc8ce64b83d6d3234a9" title="This function is used to initialize a SM4 operation context. This must be the first API called to ope...">CC_Sm4Init()</a>. It must be called at least once prior to the first <a class="el" href="group__cc__sm4.html#gab446dc6a54a6df7ddd45165e867c5df9" title="This function performs a SM4 operation on an input data buffer, according to the configuration define...">CC_Sm4Block()</a> operation on the same context - for those ciphers that require it. If needed, it can also be called to override the IV in the middle of a sequence of <a class="el" href="group__cc__sm4.html#gab446dc6a54a6df7ddd45165e867c5df9" title="This function performs a SM4 operation on an input data buffer, according to the configuration define...">CC_Sm4Block()</a> operations. </p>
<dl class="section return"><dt>Returns</dt><dd><code>CC_OK</code> on success, </dd>
<dd>
A non-zero value from <a class="el" href="cc__sm4__error_8h.html" title="This file contains the definitions of the CryptoCell SM4 errors.">cc_sm4_error.h</a> on failure. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pContext</td><td>Pointer to the SM4 context. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pIV</td><td>Pointer to the buffer of the IV, counter or tweak. <ul>
<li>
For CBC mode - the IV value. </li>
<li>
For CTR mode - the counter. </li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga0579ddef3831439a97d87e12b442e015"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga0579ddef3831439a97d87e12b442e015">&#9670;&nbsp;</a></span>CC_Sm4SetKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cc__pal__types__plat_8h.html#ae6af89d003c202f74ab7bc4c8cd26b74">CIMPORT_C</a> <a class="el" href="cc__pal__types__plat_8h.html#a0524980129b7e5ec9d0998ddab83dd1a">CCError_t</a> CC_Sm4SetKey </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_c_c_sm4_user_context__t.html">CCSm4UserContext_t</a> *&#160;</td>
          <td class="paramname"><em>pContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__cc__sm4__defs.html#gafe4fc212425e9b0e7829eb10810285f2">CCSm4Key_t</a>&#160;</td>
          <td class="paramname"><em>pKey</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function sets the key information for the SM4 operation, in the context that was initialized by <a class="el" href="group__cc__sm4.html#ga1164ff1f48b44cc8ce64b83d6d3234a9" title="This function is used to initialize a SM4 operation context. This must be the first API called to ope...">CC_Sm4Init()</a>. </p>
<dl class="section return"><dt>Returns</dt><dd><code>CC_OK</code> on success, </dd>
<dd>
A non-zero value from <a class="el" href="cc__sm4__error_8h.html" title="This file contains the definitions of the CryptoCell SM4 errors.">cc_sm4_error.h</a> on failure. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pContext</td><td>Pointer to the SM4 context, after it was initialized by <a class="el" href="group__cc__sm4.html#ga1164ff1f48b44cc8ce64b83d6d3234a9" title="This function is used to initialize a SM4 operation context. This must be the first API called to ope...">CC_Sm4Init()</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pKey</td><td>Pointer to the key data struct to be used for the SM4 operation. Must be 128 bits. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Copyright © 2001-2020 Arm Limited. All rights reserved. Non-Confidential.</li>
  </ul>
</div>
</body>
</html>
