<!-- HTML header for doxygen 1.8.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<title>Arm® CryptoCell™-713 Software Developers Manual: CryptoCell ECDSA APIs</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="arm_sip_html.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="arm_logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Arm® CryptoCell™-713 Software Developers Manual
   &#160;<span id="projectnumber">r0p0</span>
   </div>
   <div id="projectbrief">Runtime API Layer</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group__cc__ecpki__ecdsa.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">CryptoCell ECDSA APIs<div class="ingroups"><a class="el" href="group__cc__ecpki.html">CryptoCell ECC APIs</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Contains the APIs that support the ECDSA functions.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga78346a56de3170198000970d8a5e7ff0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cc__pal__types__plat_8h.html#ae6af89d003c202f74ab7bc4c8cd26b74">CIMPORT_C</a> <a class="el" href="cc__pal__types__plat_8h.html#a0524980129b7e5ec9d0998ddab83dd1a">CCError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cc__ecpki__ecdsa.html#ga78346a56de3170198000970d8a5e7ff0">CC_EcdsaSign</a> (<a class="el" href="group__cc__rnd.html#gab41230bb62b4edb0a399e44b3c974f7f">CCRndGenerateVectWorkFunc_t</a> f_rng, void *p_rng, <a class="el" href="struct_c_c_ecdsa_sign_user_context__t.html">CCEcdsaSignUserContext_t</a> *pSignUserContext, <a class="el" href="struct_c_c_ecpki_user_priv_key__t.html">CCEcpkiUserPrivKey_t</a> *pSignerPrivKey, <a class="el" href="group__cc__ecpki__types.html#ga83ed50d95cd8225fc1ca441dd3cfd814">CCEcpkiHashOpMode_t</a> hashMode, uint8_t *pMessageDataIn, size_t messageSizeInBytes, uint8_t *pSignatureOut, size_t *pSignatureOutSize)</td></tr>
<tr class="memdesc:ga78346a56de3170198000970d8a5e7ff0"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function performs an ECDSA sign operation in integrated form.  <a href="#ga78346a56de3170198000970d8a5e7ff0">More...</a><br /></td></tr>
<tr class="separator:ga78346a56de3170198000970d8a5e7ff0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1aca0dd1072f291977f0cd6248efff1f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="cc__pal__types__plat_8h.html#ae6af89d003c202f74ab7bc4c8cd26b74">CIMPORT_C</a> <a class="el" href="cc__pal__types__plat_8h.html#a0524980129b7e5ec9d0998ddab83dd1a">CCError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cc__ecpki__ecdsa.html#ga1aca0dd1072f291977f0cd6248efff1f">CC_EcdsaVerify</a> (<a class="el" href="struct_c_c_ecdsa_verify_user_context__t.html">CCEcdsaVerifyUserContext_t</a> *pVerifyUserContext, <a class="el" href="struct_c_c_ecpki_user_publ_key__t.html">CCEcpkiUserPublKey_t</a> *pUserPublKey, <a class="el" href="group__cc__ecpki__types.html#ga83ed50d95cd8225fc1ca441dd3cfd814">CCEcpkiHashOpMode_t</a> hashMode, uint8_t *pSignatureIn, size_t SignatureSizeBytes, uint8_t *pMessageDataIn, size_t messageSizeInBytes)</td></tr>
<tr class="memdesc:ga1aca0dd1072f291977f0cd6248efff1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function performs an ECDSA verify operation in integrated form. The algorithm follows the ANSI X9.62-2005: Public Key Cryptography for the Financial Services Industry, The Elliptic Curve Digital Signature Algorithm (ECDSA) standard.  <a href="#ga1aca0dd1072f291977f0cd6248efff1f">More...</a><br /></td></tr>
<tr class="separator:ga1aca0dd1072f291977f0cd6248efff1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Contains the APIs that support the ECDSA functions. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga78346a56de3170198000970d8a5e7ff0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga78346a56de3170198000970d8a5e7ff0">&#9670;&nbsp;</a></span>CC_EcdsaSign()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cc__pal__types__plat_8h.html#ae6af89d003c202f74ab7bc4c8cd26b74">CIMPORT_C</a> <a class="el" href="cc__pal__types__plat_8h.html#a0524980129b7e5ec9d0998ddab83dd1a">CCError_t</a> CC_EcdsaSign </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__cc__rnd.html#gab41230bb62b4edb0a399e44b3c974f7f">CCRndGenerateVectWorkFunc_t</a>&#160;</td>
          <td class="paramname"><em>f_rng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p_rng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_c_c_ecdsa_sign_user_context__t.html">CCEcdsaSignUserContext_t</a> *&#160;</td>
          <td class="paramname"><em>pSignUserContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_c_c_ecpki_user_priv_key__t.html">CCEcpkiUserPrivKey_t</a> *&#160;</td>
          <td class="paramname"><em>pSignerPrivKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__cc__ecpki__types.html#ga83ed50d95cd8225fc1ca441dd3cfd814">CCEcpkiHashOpMode_t</a>&#160;</td>
          <td class="paramname"><em>hashMode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pMessageDataIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>messageSizeInBytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pSignatureOut</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *&#160;</td>
          <td class="paramname"><em>pSignatureOutSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function performs an ECDSA sign operation in integrated form. </p>
<dl class="section note"><dt>Note</dt><dd>Use of HASH functions with HASH size greater than EC modulus size, is not recommended. Algorithm according to the ANSI X9.62-2005: Public Key Cryptography for the Financial Services Industry, The Elliptic Curve Digital Signature Algorithm (ECDSA) standard.</dd></dl>
<p>The message data may be either a non-hashed data or a digest of a hash function. For a non-hashed data, the message data will be hashed using the hash function indicated by <a class="el" href="group__cc__ecpki__types.html#ga83ed50d95cd8225fc1ca441dd3cfd814" title="Hash operation mode.">CCEcpkiHashOpMode_t</a>. For a digest, <a class="el" href="group__cc__ecpki__types.html#ga83ed50d95cd8225fc1ca441dd3cfd814" title="Hash operation mode.">CCEcpkiHashOpMode_t</a> should indicate the hash function that the message data was created by, and it will not be hashed.</p>
<dl class="section note"><dt>Note</dt><dd>MD5 HASH mode is not supported. </dd></dl>
<dl class="section return"><dt>Returns</dt><dd><code>CC_OK</code> on success. </dd>
<dd>
A non-zero value on failure, as defined in <a class="el" href="cc__ecpki__error_8h.html" title="This file contains the definitions of the CryptoCell ECPKI errors.">cc_ecpki_error.h</a>, <a class="el" href="cc__hash__error_8h.html" title="This file contains the definitions of the CryptoCell hash errors.">cc_hash_error.h</a> or <a class="el" href="cc__rnd__error_8h.html" title="This file contains the definitions of the CryptoCell RND errors.">cc_rnd_error.h</a>. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">f_rng</td><td>Pointer to DRBG function </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">p_rng</td><td>Pointer to the random context - the input to f_rng. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pSignUserContext</td><td>Pointer to the user buffer for signing the database. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pSignerPrivKey</td><td>A pointer to a user private key structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hashMode</td><td>One of the supported SHA-x HASH modes, as defined in <a class="el" href="group__cc__ecpki__types.html#ga83ed50d95cd8225fc1ca441dd3cfd814" title="Hash operation mode.">CCEcpkiHashOpMode_t</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pMessageDataIn</td><td>Pointer to the input data to be signed. The size of the scatter/gather list representing the data buffer is limited to 128 entries, and the size of each entry is limited to 64KB (fragments larger than 64KB are broken into fragments &lt;= 64KB). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">messageSizeInBytes</td><td>Size of message data in bytes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pSignatureOut</td><td>Pointer to a buffer for output of signature. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pSignatureOutSize</td><td>Pointer to the signature size. Used to pass the size of the SignatureOut buffer (<code>in</code>), which must be greater than or equal to 2 * OrderSizeInBytes. When the API returns, it is replaced with the size of the actual signature (<code>out</code>). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga1aca0dd1072f291977f0cd6248efff1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga1aca0dd1072f291977f0cd6248efff1f">&#9670;&nbsp;</a></span>CC_EcdsaVerify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="cc__pal__types__plat_8h.html#ae6af89d003c202f74ab7bc4c8cd26b74">CIMPORT_C</a> <a class="el" href="cc__pal__types__plat_8h.html#a0524980129b7e5ec9d0998ddab83dd1a">CCError_t</a> CC_EcdsaVerify </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_c_c_ecdsa_verify_user_context__t.html">CCEcdsaVerifyUserContext_t</a> *&#160;</td>
          <td class="paramname"><em>pVerifyUserContext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_c_c_ecpki_user_publ_key__t.html">CCEcpkiUserPublKey_t</a> *&#160;</td>
          <td class="paramname"><em>pUserPublKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__cc__ecpki__types.html#ga83ed50d95cd8225fc1ca441dd3cfd814">CCEcpkiHashOpMode_t</a>&#160;</td>
          <td class="paramname"><em>hashMode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pSignatureIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>SignatureSizeBytes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pMessageDataIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>messageSizeInBytes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function performs an ECDSA verify operation in integrated form. The algorithm follows the ANSI X9.62-2005: Public Key Cryptography for the Financial Services Industry, The Elliptic Curve Digital Signature Algorithm (ECDSA) standard. </p>
<p>The message data may be either a non-hashed data or a digest of a hash function. For a non-hashed data, the message data will be hashed using the hash function indicated by <a class="el" href="group__cc__ecpki__types.html#ga83ed50d95cd8225fc1ca441dd3cfd814" title="Hash operation mode.">CCEcpkiHashOpMode_t</a>. For a digest, <a class="el" href="group__cc__ecpki__types.html#ga83ed50d95cd8225fc1ca441dd3cfd814" title="Hash operation mode.">CCEcpkiHashOpMode_t</a> should indicate the hash function that the message data was created by, and it will not be hashed.</p>
<dl class="section note"><dt>Note</dt><dd>MD5 HASH mode is not supported. </dd></dl>
<dl class="section return"><dt>Returns</dt><dd><code>CC_OK</code> on success. </dd>
<dd>
A non-zero value on failure, as defined in <a class="el" href="cc__ecpki__error_8h.html" title="This file contains the definitions of the CryptoCell ECPKI errors.">cc_ecpki_error.h</a> or <a class="el" href="cc__hash__error_8h.html" title="This file contains the definitions of the CryptoCell hash errors.">cc_hash_error.h</a>. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pVerifyUserContext</td><td>Pointer to the user buffer for signing the database. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pUserPublKey</td><td>Pointer to a user public key structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hashMode</td><td>One of the supported SHA-x HASH modes, as defined in <a class="el" href="group__cc__ecpki__types.html#ga83ed50d95cd8225fc1ca441dd3cfd814" title="Hash operation mode.">CCEcpkiHashOpMode_t</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pSignatureIn</td><td>Pointer to the signature to be verified. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">SignatureSizeBytes</td><td>Size of the signature (in bytes). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pMessageDataIn</td><td>Pointer to the input data that was signed (same as given to the signing function). The size of the scatter/gather list representing the data buffer is limited to 128 entries, and the size of each entry is limited to 64KB (fragments larger than 64KB are broken into fragments smaller than or equal to 64KB). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">messageSizeInBytes</td><td>Size of the input data (in bytes). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Copyright © 2001-2020 Arm Limited. All rights reserved. Non-Confidential.</li>
  </ul>
</div>
</body>
</html>
