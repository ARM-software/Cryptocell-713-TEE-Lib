<!-- HTML header for doxygen 1.8.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<title>Arm® CryptoCell™-713 Software Developers Manual: CryptoCell utility functions and definitions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="arm_sip_html.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="arm_logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Arm® CryptoCell™-713 Software Developers Manual
   &#160;<span id="projectnumber">r0p0</span>
   </div>
   <div id="projectbrief">Runtime API Layer</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group__cc__util__functions.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">CryptoCell utility functions and definitions<div class="ingroups"><a class="el" href="group__cc__utils.html">CryptoCell utility APIs</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Contains CryptoCell utility functions and definitions.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_c_c_util_ek_privkey__t.html">CCUtilEkPrivkey_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_c_c_util_ek_pubkey__t.html">CCUtilEkPubkey_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_c_c_util_ek_temp_data__t.html">CCUtilEkTempData_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga29a76bba06e2e1112f2737dc68ebde6f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cc__util__functions.html#ga29a76bba06e2e1112f2737dc68ebde6f">CC_UTIL_EK_BUFF_MAX_LENGTH</a>&#160;&#160;&#160;32</td></tr>
<tr class="separator:ga29a76bba06e2e1112f2737dc68ebde6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:gaa75acb27a332faacfe34a50fab6f7a4b"><td class="memItemLeft" align="right" valign="top">typedef uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cc__util__functions.html#gaa75acb27a332faacfe34a50fab6f7a4b">CCUtilEkBuf_t</a>[<a class="el" href="group__cc__util__functions.html#ga29a76bba06e2e1112f2737dc68ebde6f">CC_UTIL_EK_BUFF_MAX_LENGTH</a>]</td></tr>
<tr class="separator:gaa75acb27a332faacfe34a50fab6f7a4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa44f983eea88136d528b94633808f5a2"><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="group__cc__cert__defs.html#ga928ed453a21bad3f379ce8b1b5f1188a">CCEcpkiKgCertContext_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cc__util__functions.html#gaa44f983eea88136d528b94633808f5a2">CCUtilEkFipsContext_t</a></td></tr>
<tr class="separator:gaa44f983eea88136d528b94633808f5a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga92e342722b5c2ac8c71e5c5a1aea35c5"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="struct_c_c_util_ek_temp_data__t.html">CCUtilEkTempData_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cc__util__functions.html#ga92e342722b5c2ac8c71e5c5a1aea35c5">CCUtilEkTempData_t</a></td></tr>
<tr class="separator:ga92e342722b5c2ac8c71e5c5a1aea35c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:ga23f980fc8a39987cab9bb05adfb22680"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cc__util__functions.html#ga23f980fc8a39987cab9bb05adfb22680">CCUtilEkDomainID_t</a> { <a class="el" href="group__cc__util__functions.html#gga23f980fc8a39987cab9bb05adfb22680ae32c685ffcf19e789c6fdfeb9fc70246">CC_UTIL_EK_DomainID_secp256k1</a> = 1, 
<a class="el" href="group__cc__util__functions.html#gga23f980fc8a39987cab9bb05adfb22680a372fbd159a99a09f84b62531835c8029">CC_UTIL_EK_DomainID_secp256r1</a> = 2, 
<a class="el" href="group__cc__util__functions.html#gga23f980fc8a39987cab9bb05adfb22680aa2bad683ab77815b7023a7c0e789eb25">CC_UTIL_EK_DomainID_Max</a>, 
<a class="el" href="group__cc__util__functions.html#gga23f980fc8a39987cab9bb05adfb22680a2541cca4fa7bda68797f5988eb1b7b20">CC_UTIL_EK_DomainID_Last</a> = 0x7FFFFFFF
 }</td></tr>
<tr class="separator:ga23f980fc8a39987cab9bb05adfb22680"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaef6ccc94b832991e470ed9815f5d5b92"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__cc__utils__errors.html#ga7c059d17ee3347283a7e2793b60944d1">CCUtilError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cc__util__functions.html#gaef6ccc94b832991e470ed9815f5d5b92">CC_UtilDeriveEndorsementKey</a> (<a class="el" href="group__cc__util__functions.html#ga23f980fc8a39987cab9bb05adfb22680">CCUtilEkDomainID_t</a> domainID, <a class="el" href="struct_c_c_util_ek_privkey__t.html">CCUtilEkPrivkey_t</a> *pPrivKey_ptr, <a class="el" href="struct_c_c_util_ek_pubkey__t.html">CCUtilEkPubkey_t</a> *pPublKey_ptr, <a class="el" href="struct_c_c_util_ek_temp_data__t.html">CCUtilEkTempData_t</a> *pTempDataBuf, <a class="el" href="group__cc__rnd.html#gab41230bb62b4edb0a399e44b3c974f7f">CCRndGenerateVectWorkFunc_t</a> f_rng, void *p_rng, <a class="el" href="group__cc__util__functions.html#gaa44f983eea88136d528b94633808f5a2">CCUtilEkFipsContext_t</a> *pEkFipsCtx)</td></tr>
<tr class="memdesc:gaef6ccc94b832991e470ed9815f5d5b92"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function computes the device unique endorsement key, as an ECC256 key pair, derived from the device root key (HUK).  <a href="#gaef6ccc94b832991e470ed9815f5d5b92">More...</a><br /></td></tr>
<tr class="separator:gaef6ccc94b832991e470ed9815f5d5b92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8a59bb8c0c5538b766360d8adbc26ff7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__cc__utils__errors.html#ga7c059d17ee3347283a7e2793b60944d1">CCUtilError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__cc__util__functions.html#ga8a59bb8c0c5538b766360d8adbc26ff7">CC_UtilSetSessionKey</a> (<a class="el" href="group__cc__rnd.html#gab41230bb62b4edb0a399e44b3c974f7f">CCRndGenerateVectWorkFunc_t</a> f_rng, void *p_rng)</td></tr>
<tr class="memdesc:ga8a59bb8c0c5538b766360d8adbc26ff7"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function builds a random session key (KSESS), and sets it to the session key registers. It must be used as early as possible during the boot sequence, but only after the RNG is initialized.  <a href="#ga8a59bb8c0c5538b766360d8adbc26ff7">More...</a><br /></td></tr>
<tr class="separator:ga8a59bb8c0c5538b766360d8adbc26ff7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Contains CryptoCell utility functions and definitions. </p>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ga29a76bba06e2e1112f2737dc68ebde6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga29a76bba06e2e1112f2737dc68ebde6f">&#9670;&nbsp;</a></span>CC_UTIL_EK_BUFF_MAX_LENGTH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CC_UTIL_EK_BUFF_MAX_LENGTH&#160;&#160;&#160;32</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Endorsement key maximal modulus length. </p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="gaa75acb27a332faacfe34a50fab6f7a4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa75acb27a332faacfe34a50fab6f7a4b">&#9670;&nbsp;</a></span>CCUtilEkBuf_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef uint8_t CCUtilEkBuf_t[<a class="el" href="group__cc__util__functions.html#ga29a76bba06e2e1112f2737dc68ebde6f">CC_UTIL_EK_BUFF_MAX_LENGTH</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Endorsement key buffer definition. </p>

</div>
</div>
<a id="gaa44f983eea88136d528b94633808f5a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa44f983eea88136d528b94633808f5a2">&#9670;&nbsp;</a></span>CCUtilEkFipsContext_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="group__cc__cert__defs.html#ga928ed453a21bad3f379ce8b1b5f1188a">CCEcpkiKgCertContext_t</a> <a class="el" href="group__cc__util__functions.html#gaa44f983eea88136d528b94633808f5a2">CCUtilEkFipsContext_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>FIPS context definition, which is required for FIPS certification. </p>

</div>
</div>
<a id="ga92e342722b5c2ac8c71e5c5a1aea35c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga92e342722b5c2ac8c71e5c5a1aea35c5">&#9670;&nbsp;</a></span>CCUtilEkTempData_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="struct_c_c_util_ek_temp_data__t.html">CCUtilEkTempData_t</a>  <a class="el" href="struct_c_c_util_ek_temp_data__t.html">CCUtilEkTempData_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Temporary buffer Definitions. </p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="ga23f980fc8a39987cab9bb05adfb22680"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga23f980fc8a39987cab9bb05adfb22680">&#9670;&nbsp;</a></span>CCUtilEkDomainID_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="group__cc__util__functions.html#ga23f980fc8a39987cab9bb05adfb22680">CCUtilEkDomainID_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Endorsement key domain ID. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="gga23f980fc8a39987cab9bb05adfb22680ae32c685ffcf19e789c6fdfeb9fc70246"></a>CC_UTIL_EK_DomainID_secp256k1&#160;</td><td class="fielddoc"><p>secp256k1 domain definition. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga23f980fc8a39987cab9bb05adfb22680a372fbd159a99a09f84b62531835c8029"></a>CC_UTIL_EK_DomainID_secp256r1&#160;</td><td class="fielddoc"><p>secp256r1 domain definition. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga23f980fc8a39987cab9bb05adfb22680aa2bad683ab77815b7023a7c0e789eb25"></a>CC_UTIL_EK_DomainID_Max&#160;</td><td class="fielddoc"><p>Reserved. </p>
</td></tr>
<tr><td class="fieldname"><a id="gga23f980fc8a39987cab9bb05adfb22680a2541cca4fa7bda68797f5988eb1b7b20"></a>CC_UTIL_EK_DomainID_Last&#160;</td><td class="fielddoc"><p>Reserved. </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="gaef6ccc94b832991e470ed9815f5d5b92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaef6ccc94b832991e470ed9815f5d5b92">&#9670;&nbsp;</a></span>CC_UtilDeriveEndorsementKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__cc__utils__errors.html#ga7c059d17ee3347283a7e2793b60944d1">CCUtilError_t</a> CC_UtilDeriveEndorsementKey </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__cc__util__functions.html#ga23f980fc8a39987cab9bb05adfb22680">CCUtilEkDomainID_t</a>&#160;</td>
          <td class="paramname"><em>domainID</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_c_c_util_ek_privkey__t.html">CCUtilEkPrivkey_t</a> *&#160;</td>
          <td class="paramname"><em>pPrivKey_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_c_c_util_ek_pubkey__t.html">CCUtilEkPubkey_t</a> *&#160;</td>
          <td class="paramname"><em>pPublKey_ptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_c_c_util_ek_temp_data__t.html">CCUtilEkTempData_t</a> *&#160;</td>
          <td class="paramname"><em>pTempDataBuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__cc__rnd.html#gab41230bb62b4edb0a399e44b3c974f7f">CCRndGenerateVectWorkFunc_t</a>&#160;</td>
          <td class="paramname"><em>f_rng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p_rng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__cc__util__functions.html#gaa44f983eea88136d528b94633808f5a2">CCUtilEkFipsContext_t</a> *&#160;</td>
          <td class="paramname"><em>pEkFipsCtx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function computes the device unique endorsement key, as an ECC256 key pair, derived from the device root key (HUK). </p>
<dl class="section return"><dt>Returns</dt><dd><code>CC_UTIL_OK</code> on success. </dd>
<dd>
A non-zero value on failure as defined <a class="el" href="cc__util__error_8h.html" title="This file contains the error definitions of the CryptoCell utility APIs.">cc_util_error.h</a>.</dd></dl>
<p>Prior to using this ECC key pair with CryptoCell ECC APIs, translate the domain ID that was used to create it, to a CryptoCell domain ID: </p><ul>
<li>
<code>CC_UTIL_EK_DomainID_secp256r1</code> - <code>CC_ECPKI_DomainID_secp256r1</code>. </li>
<li>
<code>CC_UTIL_EK_DomainID_secp256k1</code> - <code>CC_ECPKI_DomainID_secp256k1</code>.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">domainID</td><td>Selection of domain ID for the key. The following domain IDs are supported: <ul>
<li>
<code>CC_UTIL_EK_DomainID_secp256r1</code> (compliant with Trusted Board Boot Requirements CLIENT (TBBR-CLIENT) Armv8-A). </li>
<li>
<code>CC_UTIL_EK_DomainID_secp256k1</code>. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pPrivKey_ptr</td><td>Pointer to the derived private key. To use this private key with CryptoCell ECC, use <a class="el" href="group__cc__ecpki.html#ga64da5c0ad2a43995b70be3530dbaec10" title="Builds (imports) the user private key structure from an existing private key so that this structure c...">CC_EcpkiPrivKeyBuild</a> (CryptoCell domainID, pPrivKey_ptr, sizeof(*pPrivKey_ptr), UserPrivKey_ptr) to convert to CryptoCell ECC private key format. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pPublKey_ptr</td><td>Pointer to the derived public key, in [X||Y] format (X and Y being the point coordinates). To use this public key with CryptoCell ECC: <ul>
<li>
Concatenate a single byte with value 0x04 (indicating uncompressed format) with pPublKey_ptr in the following order [0x04||X||Y]. </li>
<li>
Call <a class="el" href="group__cc__ecpki.html#ga6c49c7b8c24ceff4c7e0492d5876cf85" title="This macro calls CC_EcpkiPublKeyBuildAndCheck() function for building the public key while checking i...">CC_EcpkiPubKeyBuild</a> (CryptoCell domainID, [PC || pPublKey_ptr], 1+sizeof(*pPublKey_ptr), UserPublKey_ptr) to convert to CC_ECC public key format.</li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pTempDataBuf</td><td>Temporary buffers for internal use. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">f_rng</td><td>Pointer to DRBG function </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">p_rng</td><td>Pointer to the RND context buffer used in case FIPS certification if required (may be NULL for all other cases). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pEkFipsCtx</td><td>Pointer to temporary buffer used in case FIPS certification if required (may be <code>NULL</code> for all other cases). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ga8a59bb8c0c5538b766360d8adbc26ff7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8a59bb8c0c5538b766360d8adbc26ff7">&#9670;&nbsp;</a></span>CC_UtilSetSessionKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__cc__utils__errors.html#ga7c059d17ee3347283a7e2793b60944d1">CCUtilError_t</a> CC_UtilSetSessionKey </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__cc__rnd.html#gab41230bb62b4edb0a399e44b3c974f7f">CCRndGenerateVectWorkFunc_t</a>&#160;</td>
          <td class="paramname"><em>f_rng</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>p_rng</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function builds a random session key (KSESS), and sets it to the session key registers. It must be used as early as possible during the boot sequence, but only after the RNG is initialized. </p>
<dl class="section note"><dt>Note</dt><dd>If this function is called more than once, each subsequent call invalidates any prior session-key-based authentication. These prior authentications have to be authenticated again. </dd></dl>
<dl class="section user"><dt></dt><dd></dd></dl>
<dl class="section note"><dt>Note</dt><dd>Whenever the device reconfigures memory buffers previously used for Secure content, to become accessible from Non-secure context, <a class="el" href="group__cc__util__functions.html#ga8a59bb8c0c5538b766360d8adbc26ff7" title="This function builds a random session key (KSESS), and sets it to the session key registers....">CC_UtilSetSessionKey</a> must be invoked to set a new session key, and thus invalidate any existing secure key packages.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd><code>CC_UTIL_OK</code> on success. </dd>
<dd>
A non-zero value from <a class="el" href="cc__util__error_8h.html" title="This file contains the error definitions of the CryptoCell utility APIs.">cc_util_error.h</a> on failure. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">f_rng</td><td>Pointer to DRBG function </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">p_rng</td><td>Pointer to the random context - the input to f_rng. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Copyright © 2001-2020 Arm Limited. All rights reserved. Non-Confidential.</li>
  </ul>
</div>
</body>
</html>
