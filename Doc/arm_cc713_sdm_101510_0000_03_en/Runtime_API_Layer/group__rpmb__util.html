<!-- HTML header for doxygen 1.8.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<title>Arm® CryptoCell™-713 Software Developers Manual: RPMB functions and definitions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="arm_sip_html.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="arm_logo.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Arm® CryptoCell™-713 Software Developers Manual
   &#160;<span id="projectnumber">r0p0</span>
   </div>
   <div id="projectbrief">Runtime API Layer</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('group__rpmb__util.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">RPMB functions and definitions<div class="ingroups"><a class="el" href="group__cc__utils.html">CryptoCell utility APIs</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Contains the functions and definitions for the Replay Protected Memory Block.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ga5e67dfe32ae42a3161e64f490364875e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rpmb__util.html#ga5e67dfe32ae42a3161e64f490364875e">CC_UTIL_RPMB_DATA_FRAME_SIZE_IN_BYTES</a>&#160;&#160;&#160;284</td></tr>
<tr class="separator:ga5e67dfe32ae42a3161e64f490364875e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8b88f2ad1bffabb2f92c4d47a3ce80c2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rpmb__util.html#ga8b88f2ad1bffabb2f92c4d47a3ce80c2">CC_UTIL_MIN_RPMB_DATA_BUFFERS</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:ga8b88f2ad1bffabb2f92c4d47a3ce80c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae280e06466713f4617503adfefdabe87"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rpmb__util.html#gae280e06466713f4617503adfefdabe87">CC_UTIL_MAX_RPMB_DATA_BUFFERS</a>&#160;&#160;&#160;65535</td></tr>
<tr class="separator:gae280e06466713f4617503adfefdabe87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga535d1ee56bd490a4300b3bcbc1a45889"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rpmb__util.html#ga535d1ee56bd490a4300b3bcbc1a45889">CC_UTIL_HMAC_SHA256_DIGEST_SIZE_IN_WORDS</a>&#160;&#160;&#160;8</td></tr>
<tr class="separator:ga535d1ee56bd490a4300b3bcbc1a45889"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga7a11a7d6d4a4a03dc564d1056e40a2ca"><td class="memItemLeft" align="right" valign="top">typedef uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rpmb__util.html#ga7a11a7d6d4a4a03dc564d1056e40a2ca">CCUtilRpmbKey_t</a>[<a class="el" href="group__cc__utils__defs.html#gafbdd20615ed5d4b250d14717702778bc">CC_UTIL_AES_CMAC_RESULT_SIZE_IN_BYTES</a> *2]</td></tr>
<tr class="separator:ga7a11a7d6d4a4a03dc564d1056e40a2ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae177a002024a26902d6693be15c6c3ed"><td class="memItemLeft" align="right" valign="top">typedef uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rpmb__util.html#gae177a002024a26902d6693be15c6c3ed">CCUtilRpmbDataBuffer_t</a>[<a class="el" href="group__rpmb__util.html#ga5e67dfe32ae42a3161e64f490364875e">CC_UTIL_RPMB_DATA_FRAME_SIZE_IN_BYTES</a>]</td></tr>
<tr class="separator:gae177a002024a26902d6693be15c6c3ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8d2bc624682205db5585ee9f60c9cc47"><td class="memItemLeft" align="right" valign="top">typedef uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rpmb__util.html#ga8d2bc624682205db5585ee9f60c9cc47">CCUtilHmacResult_t</a>[<a class="el" href="group__rpmb__util.html#ga535d1ee56bd490a4300b3bcbc1a45889">CC_UTIL_HMAC_SHA256_DIGEST_SIZE_IN_WORDS</a>]</td></tr>
<tr class="separator:ga8d2bc624682205db5585ee9f60c9cc47"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gacac48e7ab664316f3fa08f623f414ecb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__cc__utils__errors.html#ga7c059d17ee3347283a7e2793b60944d1">CCUtilError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rpmb__util.html#gacac48e7ab664316f3fa08f623f414ecb">CC_UtilDeriveRPMBKey</a> (<a class="el" href="group__rpmb__util.html#ga7a11a7d6d4a4a03dc564d1056e40a2ca">CCUtilRpmbKey_t</a> pRpmbKey)</td></tr>
<tr class="memdesc:gacac48e7ab664316f3fa08f623f414ecb"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function derives a 256-bit RPMB key by performing AES CMAC on fixed data, using Huk. Because the derivation is performed based on fixed data, the key does not need to be saved and can be derived again consistently.  <a href="#gacac48e7ab664316f3fa08f623f414ecb">More...</a><br /></td></tr>
<tr class="separator:gacac48e7ab664316f3fa08f623f414ecb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac185aa5c6dfd174d95a5b9dc80a8c52c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="group__cc__utils__errors.html#ga7c059d17ee3347283a7e2793b60944d1">CCUtilError_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__rpmb__util.html#gac185aa5c6dfd174d95a5b9dc80a8c52c">CC_UtilSignRPMBFrames</a> (unsigned long *pListOfDataFrames, size_t listSize, <a class="el" href="group__rpmb__util.html#ga8d2bc624682205db5585ee9f60c9cc47">CCUtilHmacResult_t</a> pHmacResult)</td></tr>
<tr class="memdesc:gac185aa5c6dfd174d95a5b9dc80a8c52c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function computes HMAC SHA-256 authentication code of a sequence of 284-byte RPMB frames (as defined in JEDEC STANDARD, Embedded Multimedia Card (eMMC), Electrical Standard), using the RPMB key (which is derived internally using <a class="el" href="group__rpmb__util.html#gacac48e7ab664316f3fa08f623f414ecb" title="This function derives a 256-bit RPMB key by performing AES CMAC on fixed data, using Huk....">CC_UtilDeriveRPMBKey</a>).  <a href="#gac185aa5c6dfd174d95a5b9dc80a8c52c">More...</a><br /></td></tr>
<tr class="separator:gac185aa5c6dfd174d95a5b9dc80a8c52c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Contains the functions and definitions for the Replay Protected Memory Block. </p>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ga535d1ee56bd490a4300b3bcbc1a45889"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga535d1ee56bd490a4300b3bcbc1a45889">&#9670;&nbsp;</a></span>CC_UTIL_HMAC_SHA256_DIGEST_SIZE_IN_WORDS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CC_UTIL_HMAC_SHA256_DIGEST_SIZE_IN_WORDS&#160;&#160;&#160;8</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>HMAC digest size in words. </p>

</div>
</div>
<a id="gae280e06466713f4617503adfefdabe87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae280e06466713f4617503adfefdabe87">&#9670;&nbsp;</a></span>CC_UTIL_MAX_RPMB_DATA_BUFFERS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CC_UTIL_MAX_RPMB_DATA_BUFFERS&#160;&#160;&#160;65535</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>RPMB maximal number of data buffers to sign on. </p>

</div>
</div>
<a id="ga8b88f2ad1bffabb2f92c4d47a3ce80c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8b88f2ad1bffabb2f92c4d47a3ce80c2">&#9670;&nbsp;</a></span>CC_UTIL_MIN_RPMB_DATA_BUFFERS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CC_UTIL_MIN_RPMB_DATA_BUFFERS&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>RPMB minimal number of data buffers to sign on. </p>

</div>
</div>
<a id="ga5e67dfe32ae42a3161e64f490364875e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga5e67dfe32ae42a3161e64f490364875e">&#9670;&nbsp;</a></span>CC_UTIL_RPMB_DATA_FRAME_SIZE_IN_BYTES</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CC_UTIL_RPMB_DATA_FRAME_SIZE_IN_BYTES&#160;&#160;&#160;284</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>RPMB frame size in bytes. </p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="ga8d2bc624682205db5585ee9f60c9cc47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8d2bc624682205db5585ee9f60c9cc47">&#9670;&nbsp;</a></span>CCUtilHmacResult_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef uint32_t CCUtilHmacResult_t[<a class="el" href="group__rpmb__util.html#ga535d1ee56bd490a4300b3bcbc1a45889">CC_UTIL_HMAC_SHA256_DIGEST_SIZE_IN_WORDS</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>definition of HMAC result. </p>

</div>
</div>
<a id="gae177a002024a26902d6693be15c6c3ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gae177a002024a26902d6693be15c6c3ed">&#9670;&nbsp;</a></span>CCUtilRpmbDataBuffer_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef uint8_t CCUtilRpmbDataBuffer_t[<a class="el" href="group__rpmb__util.html#ga5e67dfe32ae42a3161e64f490364875e">CC_UTIL_RPMB_DATA_FRAME_SIZE_IN_BYTES</a>]</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>definition of RPMB data frame. </p>

</div>
</div>
<a id="ga7a11a7d6d4a4a03dc564d1056e40a2ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga7a11a7d6d4a4a03dc564d1056e40a2ca">&#9670;&nbsp;</a></span>CCUtilRpmbKey_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef uint8_t CCUtilRpmbKey_t[<a class="el" href="group__cc__utils__defs.html#gafbdd20615ed5d4b250d14717702778bc">CC_UTIL_AES_CMAC_RESULT_SIZE_IN_BYTES</a> *2]</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>definition of RPMB key structure. </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="gacac48e7ab664316f3fa08f623f414ecb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gacac48e7ab664316f3fa08f623f414ecb">&#9670;&nbsp;</a></span>CC_UtilDeriveRPMBKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__cc__utils__errors.html#ga7c059d17ee3347283a7e2793b60944d1">CCUtilError_t</a> CC_UtilDeriveRPMBKey </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__rpmb__util.html#ga7a11a7d6d4a4a03dc564d1056e40a2ca">CCUtilRpmbKey_t</a>&#160;</td>
          <td class="paramname"><em>pRpmbKey</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function derives a 256-bit RPMB key by performing AES CMAC on fixed data, using Huk. Because the derivation is performed based on fixed data, the key does not need to be saved and can be derived again consistently. </p>
<dl class="section return"><dt>Returns</dt><dd><code>CC_UTIL_OK</code> on success. </dd>
<dd>
A non-zero value from <a class="el" href="cc__util__error_8h.html" title="This file contains the error definitions of the CryptoCell utility APIs.">cc_util_error.h</a> on failure. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">pRpmbKey</td><td>Pointer to 32byte output, to be used as RPMB key. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="gac185aa5c6dfd174d95a5b9dc80a8c52c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gac185aa5c6dfd174d95a5b9dc80a8c52c">&#9670;&nbsp;</a></span>CC_UtilSignRPMBFrames()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="group__cc__utils__errors.html#ga7c059d17ee3347283a7e2793b60944d1">CCUtilError_t</a> CC_UtilSignRPMBFrames </td>
          <td>(</td>
          <td class="paramtype">unsigned long *&#160;</td>
          <td class="paramname"><em>pListOfDataFrames</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>listSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__rpmb__util.html#ga8d2bc624682205db5585ee9f60c9cc47">CCUtilHmacResult_t</a>&#160;</td>
          <td class="paramname"><em>pHmacResult</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function computes HMAC SHA-256 authentication code of a sequence of 284-byte RPMB frames (as defined in JEDEC STANDARD, Embedded Multimedia Card (eMMC), Electrical Standard), using the RPMB key (which is derived internally using <a class="el" href="group__rpmb__util.html#gacac48e7ab664316f3fa08f623f414ecb" title="This function derives a 256-bit RPMB key by performing AES CMAC on fixed data, using Huk....">CC_UtilDeriveRPMBKey</a>). </p>
<dl class="section return"><dt>Returns</dt><dd><code>CC_UTIL_OK</code> on success. </dd>
<dd>
A non-zero value from <a class="el" href="cc__util__error_8h.html" title="This file contains the error definitions of the CryptoCell utility APIs.">cc_util_error.h</a> on failure. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pListOfDataFrames</td><td>Pointer to a list of 284-byte frame addresses. The entire frame list is signed. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">listSize</td><td>The number of 284-byte frames in the list, up to 65,535. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pHmacResult</td><td>Pointer to the output data (HMAC result). </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Copyright © 2001-2020 Arm Limited. All rights reserved. Non-Confidential.</li>
  </ul>
</div>
</body>
</html>
